import{a as j}from"./chunk-XUP662KI.js";import{a as E}from"./chunk-G5KA7DMQ.js";import{B as g,F as c,G as r,H as i,I as l,J as I,K as k,L as s,N as d,O as f,P as x,Q as h,R as C,U as B,V as S,aa as y,ba as O,ca as P,da as U,ka as M,m as u,n as v,qa as T,t as _,u as o,w as m,x as w}from"./chunk-3J3GWWA6.js";function F(n,t){if(n&1){let e=I();r(0,"div",13)(1,"button",14),l(2,"i",15),i(),r(3,"ul",16)(4,"li")(5,"a",17),k("click",function(p){u(e);let b=s().$implicit;return s().goToUpdateForm(b.id),v(p.stopPropagation())}),l(6,"i",18),d(7," Update "),i()(),r(8,"li")(9,"a",19),k("click",function(p){u(e);let b=s().$implicit;return s().deleteBook(b.id),v(p.stopPropagation())}),l(10,"i",20),d(11," Remove "),i()()()()}}function V(n,t){if(n&1&&(r(0,"div",3)(1,"div",4),g(2,F,12,0,"div",5),r(3,"div",6)(4,"h6",7),d(5),i(),r(6,"small",8),d(7),i(),r(8,"small",9),d(9),i()(),r(10,"div",10),l(11,"img",11),i(),r(12,"div",12),d(13),B(14,"date"),i()()()),n&2){let e=t.$implicit,a=s();o(2),c("ngIf",e.userId===a.currentUserId),o(2),c("title",h(e.title)),o(),f(e.title),o(),c("title",h(e.author)),o(),f(e.author),o(),c("title",C("User ID: ",e.userId)),o(),x("Published by user: ",e.userId),o(2),c("src",a.isValidImageUrl(e.imageUrl)?e.imageUrl:"https://www.pngmart.com/files/8/Book-Cover-Transparent-Background.png",_),o(2),x(" Published: ",S(14,12,e.publishedDate)," ")}}var D=class n{constructor(t,e,a){this.bookService=t;this.auth=e;this.router=a}books=[];currentUserId=null;ngOnInit(){this.fetchBooks(),this.setCurrentUserId()}setCurrentUserId(){let t=this.auth.getToken();if(t)try{let e=E(t);this.currentUserId=+e["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||+e.sub||null}catch(e){console.error("Invalid token",e),this.currentUserId=null}}fetchBooks(){this.bookService.getBooks().subscribe(t=>{this.books=t.reverse()})}deleteBook(t){this.bookService.deleteBook(t).subscribe(()=>{this.books=this.books.filter(e=>e.id!==t)})}goToUpdateForm(t){console.log("Navigating to update form for book ID:",t),this.router.navigate(["/update",t])}isValidImageUrl(t){if(!t)return!1;let e=t.split("?")[0].toLowerCase();return(e.startsWith("http://")||e.startsWith("https://"))&&(e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".png"))}static \u0275fac=function(e){return new(e||n)(m(j),m(T),m(M))};static \u0275cmp=w({type:n,selectors:[["app-book-list"]],decls:3,vars:1,consts:[[1,"container","mt-5"],[1,"row","row-cols-2","row-cols-md-3","row-cols-lg-5","g-4"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[1,"card","shadow-sm","position-relative","d-flex","flex-column","book-card"],["class","position-absolute top-0 end-0 m-2 dropdown z-3",4,"ngIf"],[1,"card-body","text-center","py-2","flex-shrink-0"],[1,"card-title","mb-1","text-truncate",3,"title"],[1,"book-card-meta","d-block","text-truncate",3,"title"],[1,"book-card-meta","d-block",3,"title"],[1,"flex-grow-1","d-flex","align-items-center","justify-content-center",2,"padding","0 0.5rem"],["alt","Book Cover",1,"img-fluid",2,"max-height","100%","max-width","100%","object-fit","cover","aspect-ratio","2 / 3",3,"src"],[1,"card-footer","book-card-meta","text-center","small","flex-shrink-0","book-card-footer"],[1,"position-absolute","top-0","end-0","m-2","dropdown","z-3"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-sm","btn-icon","dropdown-toggle","book-card-btn"],[1,"fas","fa-pen"],[1,"dropdown-menu","dropdown-menu-end"],["role","button",1,"dropdown-item","cursor-pointer",3,"click"],[1,"fas","fa-edit","me-2"],["role","button",1,"dropdown-item","text-danger","cursor-pointer",3,"click"],[1,"fas","fa-trash-alt","me-2"]],template:function(e,a){e&1&&(r(0,"div",0)(1,"div",1),g(2,V,15,14,"div",2),i()()),e&2&&(o(2),c("ngForOf",a.books))},dependencies:[U,y,O,P],styles:[".book-card[_ngcontent-%COMP%]{background-color:var(--bg);color:var(--text);border:1px solid var(--card-border);min-height:24rem;overflow:visible;transition:background-color .2s,color .2s,border-color .2s;border-radius:.5rem}.book-card-footer[_ngcontent-%COMP%]{background-color:var(--footer-bg);color:var(--text);border-top:1px solid var(--card-border);padding:.5rem}.book-card-btn[_ngcontent-%COMP%]{background-color:transparent;border:none;color:var(--btn-icon-color);padding:.25rem;border-radius:.375rem;transition:background-color .2s,color .2s}.book-card-btn[_ngcontent-%COMP%]:hover{background-color:var(--btn-hover-bg);color:var(--hover)}.book-card-btn[_ngcontent-%COMP%]:focus{outline:none;box-shadow:none}.dropdown-menu[_ngcontent-%COMP%]{background-color:var(--nav-bg);color:var(--text);border:1px solid var(--card-border);box-shadow:0 .25rem .5rem #00000026}.dropdown-item[_ngcontent-%COMP%]{color:var(--text);transition:background-color .2s,color .2s}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:var(--btn-hover-bg);color:var(--hover)}.dropdown-item.text-danger[_ngcontent-%COMP%]{color:var(--danger-text)}.book-card-meta[_ngcontent-%COMP%]{color:var(--meta-text);font-size:.85rem}"]})};export{D as BookList};
